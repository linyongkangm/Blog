# 正则表达式解析器---第1章 用有限状态自动机描述正则表达式

正则表达式是用来描述一个字符串集合的详细说明。我们用**语言**指代一个字符串的集合，**模式**指代一种语言的详细说明，而**正则表达式**就可以用来描述模式。例如：
语言：`国内 13、14、15、18开头的手机号`组成的字符串集合，对应的模式就是：
- 头两位是13，后接9位数字；
- 头两位是14，接5或7，再接8位数字；
- 头两位是是15或18，接0/1/2/3/5/6/7/8/9其中一位，再接8位数字；

用正则表达式描述这个模式就是：  
`(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$`

## 正则表达式的基本操作
可以看到手机号的正则表达式的描述的分为以下四类操作：
- **连接操作**：连接两个字符/模式，例如：`AB`，指定的就是语言{AB}，含有一个元素AB，由A和B连接而成；
- **或操作**：指定多种可能的匹配，用竖线符号“|”表示，例如：`A|B`，指定的就是语言{A，B}，含有两个元素A和B；
- **闭包（循环）操作**：将模式的部分重复任意的次数，用“*”标记在需要被重复的模式之后，例如：`AB*`，指定的就是语言{A，AB，ABB，ABBB，AB^n}，含有无数多个元素；
- **括号**：改变默认的优先级。闭包的优先级高于或操作高于连接操作，可以使用括号改变默认的优先级顺序。

## 正则表达式的定义
一个正则表达式可以是：
- 空字符串 ε
- 单个字符
- 包含在括号中的另一个正则表达式
- 两个或多个连接起来的正则表达式
- 由或运算符分隔的两个或多个正则表达式
- 由闭包运算符标记的一个正则表达式
- 空正则表达式表示的语言是空,含有0个元素
- 一个字符表示的语言含有一个元素,即该字符本身
- (一个由括号和包含在其中的正则表达式组成的正则表达式)表示的语言,与括号内的正则表达式表示的语言相同
- 由(两个正则表达式连接起来的正则表达式)表示的语言为,(这两个正则表达式分别表示的语言)的叉乘
- 由(或运算符连接的两个正则表达式)所表示的语言为,(这两个正则表达式分别表示的语言)的并集
- 由(一个正则表达式的闭包)所表示的语言为,由 ε 或将被修饰的正则表达式所表示的语言重复任意次所得到的所有字符串组成。

## 用有限状态自动机描述正则表达式的基本操作
### 连接操作
连接操作是最容易实现的。状态的匹配转换和字母表中的字符的对应关系就是连接操作的实现。例如正则表达式`(AB)`就可以用如下自动机描述：  
![connection-operation.png](https://github.com/linyongkangm/Blog/blob/master/public/images/connection-operation.png)  

### 或操作
在形如`(A|B)`的正则表达式中，A和B也都是正则表达式。我们只需要将所有分支单独构造，再把每个分支的起始状态和结束状态用 ε 边连接起来就可以了： 
![or-operation.png](https://github.com/linyongkangm/Blog/blob/master/public/images/or-operation.png)    

### 闭包操作
对于一个闭包，意味着到达闭包的结束的时候可以再次回到开始，所以对于`(A*)`的正则表达式，可以这样描述：   
![loop-operation.png](https://github.com/linyongkangm/Blog/blob/master/public/images/loop-operation.png)   

至此，所有的正则表达式都可以使用这三种有限状态自动机描述。

## 参考
【1】[离散数学及其应用（原书第7版）](https://book.douban.com/subject/26316200/)  
【2】[算法（第4版）](https://book.douban.com/subject/19952400/)
【3】[vczh的博客](http://www.cppblog.com/vczh/archive/2008/05/22/50763.html)